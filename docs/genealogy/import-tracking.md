# Genealogy Import Tracking

**Purpose:** Track discovered entities during the import pipeline to ensure systematic coverage.

---

## Workflow Overview

1. **Start with a person or group** - Use `/import-person` or `/import-group` command
2. **Review output** - Copy generated SQL to your import file
3. **Track discovered entities** - Add new persons/groups to tracking files
4. **Repeat** - Process next entity from backlog

---

## Tracking Files

Maintain two tracking files in `docs/genealogy/import-backlog/`:

### `persons-backlog.md` - Persons to Import

```markdown
# Persons Import Backlog

## Status Legend
- `pending` - Not yet processed
- `in_progress` - Currently researching
- `done` - SQL generated, added to import set
- `skipped` - Decided not to import (document reason)

## Backlog

| Apelido | Full Name | Title | Discovered From | Status | Notes |
|---------|-----------|-------|-----------------|--------|-------|
| João Grande | João Oliveira dos Santos | mestre | GCAP import | pending | |
| Moraes | Pedro Moraes Trindade | mestre | GCAP import | pending | |
| Pastinha | Vicente Ferreira Pastinha | mestre | João Grande import | done | Historical figure |
```

### `groups-backlog.md` - Groups to Import

```markdown
# Groups Import Backlog

## Status Legend
- `pending` - Not yet processed
- `in_progress` - Currently researching
- `done` - SQL generated, added to import set
- `skipped` - Decided not to import (document reason)

## Backlog

| Name | Style | Discovered From | Status | Notes |
|------|-------|-----------------|--------|-------|
| GCAP | angola | Mestre Moraes import | pending | |
| CECA | angola | João Grande import | done | Historical |
| Grupo Senzala | mixed | Cordão de Ouro import | pending | Major group |
```

---

## Import Set Files

Store generated SQL in `docs/genealogy/import-sql/`:

### File Naming Convention

```
YYYY-MM-DD_[type]_[name].sql
```

Examples:
- `2025-01-15_person_joao-grande.sql`
- `2025-01-15_group_gcap.sql`
- `2025-01-16_person_pastinha.sql`

### Consolidation

Periodically consolidate individual import files into a batch:

```
2025-01-batch-01_historical-angoleiros.sql
```

---

## Entity Registry

Once entities are imported, track their UUIDs in `docs/genealogy/entity-registry.md`:

```markdown
# Entity Registry

## Persons

| Apelido | UUID | Imported On |
|---------|------|-------------|
| Pastinha | (will be assigned on import) | 2025-01-15 |
| João Grande | (will be assigned on import) | 2025-01-15 |

## Groups

| Name | UUID | Imported On |
|------|------|-------------|
| CECA | (will be assigned on import) | 2025-01-15 |
| GCAP | (will be assigned on import) | 2025-01-15 |
```

**Note:** UUIDs are generated by `gen_random_uuid()` at import time. After running imports, update this registry with actual UUIDs from the database.

---

## Relationship Tracking

When generating statements, track which relationships are:

### Pending (entities not yet imported)

```markdown
## Pending Relationships

| Subject | Predicate | Object | Blocked By |
|---------|-----------|--------|------------|
| Moraes | student_of | João Grande | João Grande not imported |
| GCAP | split_from_group | CECA | CECA not imported |
```

### Ready (both entities exist)

These can be added to your import SQL immediately.

---

## Typical Session Flow

1. **Pick entity from backlog** - e.g., "Mestre João Grande"
2. **Run import command** - `/import-person Mestre João Grande`
3. **Review output**
   - Copy SQL to `docs/genealogy/import-sql/2025-01-15_person_joao-grande.sql`
   - **Ensure bilingual content**: Verify both `_en` and `_pt` fields are populated for bio, achievements, style_notes (persons) or description, history, philosophy, style_notes (groups)
   - Add discovered persons to `persons-backlog.md`
   - Add discovered groups to `groups-backlog.md`
   - Mark João Grande as `done` in `persons-backlog.md`
4. **Check for ready relationships** - If related entities already done, add statements
5. **Repeat** with next entity

---

## Best Practices

1. **Start with historical figures** - They have the most documentation and are referenced by many
2. **Work in lineage chains** - Import teachers before students for cleaner relationship generation
3. **Batch by group** - When processing a group, also process key founders/leaders
4. **Verify before import** - Review all SQL before running against database
5. **Run imports in transaction** - Keep `BEGIN;` and `COMMIT;` wrapper
6. **Save UUIDs** - After import, capture actual UUIDs for future reference
7. **Capture bilingual content** - All narrative fields require both English (`_en`) and Portuguese (`_pt`) versions. See `BILINGUAL_CONTENT.md` for details

---

## Directory Structure

```
docs/genealogy/
├── import-tracking.md          # This file
├── import-backlog/
│   ├── persons-backlog.md      # Persons to import
│   └── groups-backlog.md       # Groups to import
├── import-sql/
│   ├── 2025-01-15_person_pastinha.sql
│   ├── 2025-01-15_person_joao-grande.sql
│   ├── 2025-01-15_group_ceca.sql
│   └── ...
├── entity-registry.md          # Imported entities with UUIDs
└── case-studies/               # Existing research (reference)
```
